<!DOCTYPE html>
<html>
	<body onload="init();">
		<canvas id="Canvas1">
		Your browser does not support the HTML5 canvas tag.</canvas>
		<canvas id="Canvas2">
		</canvas>
		
		<p id="demo"></p>
		
		<script>
			var c1,c2,ctx1,ctx2;
			var snake = {
				run : null,
				paused : 1,
				ptlist : [ [18,19], [19,19], [20,19], [21,19] ],
				ori : [-1,0],
				step : function() {
					var head = [(this.ptlist[0][0]+this.ori[0]+40)%40, (this.ptlist[0][1]+this.ori[1]+40)%40];
					this.ptlist.splice(0,0,head);
					var tail = this.ptlist.pop();
					
					ctx2.fillRect(head[0]*(c2.width/40)+1, head[1]*(c2.width/40)+1, (c2.width/40)-2, (c2.width/40)-2);
					ctx2.clearRect(tail[0]*(c2.width/40)+1, tail[1]*(c2.width/40)+1, (c2.width/40)-2, (c2.width/40)-2);
				},
				init : function() {
					c2=document.getElementById("Canvas2");
					ctx2=c2.getContext("2d");
					drawSnake();
					this.begin();
				},
				begin : function(){
					window.addEventListener( "keydown", control, false );
					this.continue();
				},
				stop_s : function(){
					this.pause();
					window.removeEventListener( "keydown", control, false );
				},
				pause : function() {
					clearInterval(this.run);
					this.paused = 1;
				},
				continue : function() {
					this.run = setInterval(function(){snake.step()},100);
					this.paused = 0;
				}
			};
			function init(){
				c1=document.getElementById("Canvas1");
				ctx1=c1.getContext("2d");
				drawC1();
				snake.init();
				window.addEventListener( "resize", redraw, false );
				document.getElementById("demo").innerHTML = c1.width + " " + c1.height + " " + c2.width + " " + c2.height;
			}
			function control(event){
				//alert(event.keyCode);
				if(!snake.paused){
					switch(event.keyCode){
						case 37:
						if(snake.ori[0]!=1){
							snake.ori=[-1,0];
						}
						break;
						case 38:
						if(snake.ori[1]!=1){
							snake.ori=[0,-1];
						}
						break;
						case 39:
						if(snake.ori[0]!=-1){
							snake.ori=[1,0];
						}
						break;
						case 40:
						if(snake.ori[1]!=-1){
							snake.ori=[0,1];
						}
						break;
					}
				}
				switch(event.keyCode){
						case 32:
						if(snake.paused){
							snake.continue();
						}
						else{
							snake.pause();
						}
					}
			}
			function redraw(){
				ctx1.clearRect(0,0,c1.width,c1.height);
				drawC1();
				
				snake.pause();
				ctx2.clearRect(0,0,c2.width,c2.height);
				drawSnake();
				snake.continue();
			}
			function drawC1(){
				c1.width = window.innerWidth/10*9;
        c1.height = Math.min(c1.width/2,window.innerHeight/2);
				ctx1.font=c1.width/10 + "px Arial";
				ctx1.strokeText("Caisn's Home Page",c1.width/20,c1.height/3);
			}
			function drawSnake(){
				c2.width=c2.height=Math.floor(Math.max(Math.min(window.innerWidth,window.innerHeight-c1.height),200)/40)*40;
				for(var i=0;i<snake.ptlist.length;i++){
					ctx2.fillRect(snake.ptlist[i][0]*(c2.width/40)+1, snake.ptlist[i][1]*(c2.width/40)+1, (c2.width/40)-2, (c2.width/40)-2);
				}
			}
		</script>
	</body>
</html>
